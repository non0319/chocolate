@use '_mixin' as *;

$card-width: 260px;
$card-height: 400px;
$overlap-amount: 50px;

.card-stack-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    margin: 100px auto 200px;
    perspective: 1500px;
}

.info-card {
    width: $card-width;
    height: $card-height;
    background-color: $sub-color;
    border-radius: 12px;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    transform-origin: 50% 100%;
    
    // ホバー解除時の戻り速度の基本設定 (0.1s)
    transition:
        transform 0.1s ease-out,
        box-shadow 0.1s ease-out,
        z-index 0.4s,
        opacity 1.2s ease-out; 
        
    margin-left: -$overlap-amount;

    &:first-child {
        margin-left: 0;
    }

    // 初期状態 (スクロール前)
    opacity: 0;
    transform: translateX(100px) rotate(0deg);

    &[data-card-id="1"] { z-index: 1; }
    &[data-card-id="2"] { z-index: 2; }
    &[data-card-id="3"] { z-index: 3; }
    &[data-card-id="4"] { z-index: 4; }
}

// ------------------------------------------------
// ★★★ アクティブ状態 (広がる演出: 1.2s) ★★★
// ------------------------------------------------
.card-stack-container.is-active {

    .info-card {
        // 広がる演出時のみ transform を1.2sに上書き
        transition: 
            transform 1.2s ease-out,
            box-shadow 0.1s ease-out,
            z-index 0.4s,
            opacity 1.2s ease-out;
            
        transition-delay: 0.1s !important;
        opacity: 1;
    }

    & .info-card[data-card-id="1"] {
        transform: rotate(-13deg) translateY(10px) translateZ(50px);
        transition-delay: 0.1s;
    }

    & .info-card[data-card-id="2"] {
        transform: rotate(-5deg) translateY(0px) translateZ(30px);
        transition-delay: 0.3s;
    }

    & .info-card[data-card-id="3"] {
        transform: rotate(5deg) translateY(20px) translateZ(10px);
        transition-delay: 0.5s;
    }

    & .info-card[data-card-id="4"] {
        transform: rotate(15deg) translateY(70px) translateZ(0px);
        transition-delay: 0.7s;
    }
}

// ------------------------------------------------
// ★ ホバーアニメーション (飛び出す演出: 0.1s) ★
// ------------------------------------------------
.info-card:hover {
    // ★最終修正: transition 全体に !important を付与し、速度を強制的に0.1sにする
    transition: 
        transform 0.1s ease-out !important, 
        box-shadow 0.1s ease-out !important, 
        z-index 0.4s !important, 
        opacity 1.2s ease-out !important;
        
    transform:
        scale(1.05) translateY(-20px) translateZ(100px) rotate(0deg) !important;
    box-shadow: 0 30px 50px rgba(0, 0, 0, 0.3);
    z-index: 10;
}


// ------------------------------------------------
// カードコンテンツのスタイル
// ------------------------------------------------
.card-image-wrapper {
    overflow: hidden;
    height: 60%;
    border-radius: 12px 12px 0 0;

    .card-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
}

.card-text-content {
    padding: 15px;
    text-align: left;

    .card-number {
        font-size: 2rem;
        font-weight: bold;
        color: $main-color;
    }

    .card-title-text {
        font-size: 1.1rem;
        margin-top: 5px;
    }
}

// ------------------------------------------------
// 詳細セクションのスタイル
// ------------------------------------------------
#card-detail-section {
    background-color: $sub-color;
    border-radius: 12px;
    padding: 30px;
    margin: 40px auto;
    width: min(90%, 900px);
    height: 0;
    opacity: 0;
    overflow: hidden;
    transition: height 0.4s ease-out, opacity 0.4s ease-out;

    &.is-open {
        height: auto;
        opacity: 1;
        min-height: 200px;
    }

    .detail-content {
        text-align: left;

        h3 {
            color: $main-color;
            margin-bottom: 10px;
        }
    }
}